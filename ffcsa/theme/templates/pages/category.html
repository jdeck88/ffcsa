{% extends "pages/page.html" %}

{% load mezzanine_tags shop_tags i18n %}
{% block body_id %}category{% endblock %}


{% block main %}{{ block.super }}

    {% include 'pages/category-alert.html' %}

    {% block content %}
        {% editable page.category.content %}
            {{ page.category.content|safe }}
        {% endeditable %}
    {% endblock content %}

    {% if child_categories %}
        {% include 'pages/category-list.html' with categories=child_categories %}
    {% endif %}

    {% if products.paginator.count != 0 %}

        <div class="row product-list">
            {% for product in products.object_list %}
                {% if product.available %}
                    <div class="col-xs-6 col-sm-4 col-lg-3 product-thumb">
                        <div class="thumbnail">
                            <a href="{{ product.get_absolute_url }}">
                                {% if product.image %}
                                    <img src="{{ MEDIA_URL }}{% thumbnail product.image 148 148 %}">
                                {% else %}
                                    <div class="placeholder"></div>
                                {% endif %}
                                <div class="caption">
                                    <h6>{{ product }}</h6>
                                </div>
                            </a>
                            {% if request.user.is_authenticated %}
                                <form method="post" class="product-quick-add-form form-group-sm">
                                    {% csrf_token %}
                                    <input type="number" class="form-control item-qty" placeholder="qty"
                                           name="item_qty"/>
                                    <input type="hidden" name="item_id" value="{{ product.id }}"/>
                                    <input type="submit" class="btn btn-primary btn-sm form-control" name="add_item"
                                           value="{% trans "Add to Order" %}">
                                </form>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>

        {% pagination_for products %}

    {% endif %}

{% endblock %}
